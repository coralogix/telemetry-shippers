# Override values for E2E test - instead of exporting to Coralogix, export to a local sink used in the E2E test
opentelemetry-agent:
  extraEnvs:
    - name: CORALOGIX_PRIVATE_KEY
      valueFrom:
        secretKeyRef:
          name: coralogix-keys
          key: PRIVATE_KEY
    - name: OTEL_RESOURCE_ATTRIBUTES
      value: "k8s.node.name=$(K8S_NODE_NAME)"
    - name: KUBE_NODE_NAME
      valueFrom:
        fieldRef:
          apiVersion: v1
          fieldPath: spec.nodeName
    - name: HOSTENDPOINT
      valueFrom:
        configMapKeyRef:
          name: otel-hostendpoint-configmap
          key: HOSTENDPOINT
  presets:
    hostMetrics:
      enabled: true
      # Enables process metrics scraping.
      # Disabled by default, requires privilleged mode
      process:
        enabled: true
      collectionInterval: "30s"
  config:
    exporters:
      otlp:
        endpoint: ${env:HOSTENDPOINT}:4317
        tls:
          insecure: true

    service:
      pipelines:
        metrics:
          exporters:
            - otlp
        traces:
          exporters:
            - otlp
        logs:
          exporters:
            - debug